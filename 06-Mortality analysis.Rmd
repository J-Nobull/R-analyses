---
title: "Week 2 Assignment"
author: "Jason Noble"
date: "08-16-2024"
output:
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: console
---
```{r Load_libraries, echo=TRUE, message=FALSE, warning=FALSE}
library(knitr)
library(ggplot2)
library(ggformula)
library(mosaic)
library(dplyr)
library(supernova)
library(car)
library(ltm)
library(lsr)
library(nycflights13)
library(fueleconomy)
library(palmerpenguins)
library(Lock5Data)

myDataLocation <- "C:/Users/NoBull/Desktop/ANA605/Week2"
setwd(myDataLocation)
NUdata <- read.csv(file = "sim_data.csv", header = TRUE)

# rows = students, columns = samples
dim(NUdata) 
```
**Question 1.**	
One Sample  

a. Plot a histogram of age for the first sample (the first column) of 100 students with a vertical line of the mean.

b. Describe the shape of the distribution.  
The distribution has a roughly symmetric shape, slightly right-skewed from a possible bimodal peak around the median of 30.

c. What does the y-axis represent?  
The y-axis is the frequency or count of the number of students who are the same age between 22-43,  
(or count of students per bin) with the most common age being 28.

```{r Question1, echo=TRUE}
age_sample <- NUdata[, 1]

gf_histogram(~ age_sample, data = NUdata, 
       binwidth = 1,
       fill = "blue4",
       color = "black") +
  labs(title = "(Fig. 1) Age Histogram for First Sample", 
       x = "Age", 
       y = "Frequency") +
  geom_vline(xintercept = mean(age_sample), 
       color = "blue", 
       linewidth = 1.33)

#d. What is the mean age for the sample?
mean(age_sample)

#e. What is the standard deviation of age for the sample?
sd1 <- round(sd(age_sample), 2)
sd1
```

**Question 2.**  
Calculate the mean ages for each sample, using the R function, apply(). You will need to figure out what values  
to put in for the three arguments, X, MARGIN, and FUN. Save the 1,000 means in a vector of age means.

a. Plot a histogram of the age means with a vertical line at the mean. (Make an SDoM)

b. Describe the shape of the distribution.  
The shape is tightly clustered around the mean, and shows a normal, bell-shaped distribution.

c.	What does the y-axis represent?  
The y-axis is the frequency of the number of means samples that have a particular mean in each age.

```{r Q2_Answers, echo=TRUE}
age_means <- apply(NUdata, MARGIN = 2, FUN = mean)

gf_histogram(~ age_means, 
       binwidth = 1, 
       fill = "blue4", 
       color = "black") +
  labs(title = "(Fig. 2) Histogram of 1,000 Age Means", 
       x = "The Mean Age", 
       y = "Frequency") +
  geom_vline(xintercept = mean(age_means), 
       color = "blue", 
       linewidth = 1.33)

#d.	What is the mean of the sampling distribution of means?
mom <- round(mean(age_means), 2)
mom

#e.	What is the standard error of the mean?
sem <- round(sd(age_means), 2)
sem
```
#f.	What notation would you use to describe the mean and standard error from 2.d-e?
$$Y_i = b_0 + b_1 + \epsilon_i$$

Substituting the values:
$$Y_i = `r mom` + `r sem`\epsilon_i$$

***

**Question 3.**  
Calculate the standard deviation for each sample, using the R function, apply(). You will need to figure out what values  
to put in for the three arguments, X, MARGIN, and FUN. Save the result in vector of age standard deviations.

a. Plot a histogram of the age standard deviations with a vertical line at the mean.

b.	Describe the shape of the distribution.  
The shape for the standard deviations is a normal, symmetric, bell curve about the mean of 3.99

c.	What does the y-axis represent?  
The frequency of the 1,000 samples that fall within each bin of the values for standard deviation.

```{r Q3_Answers, echo=TRUE}
age_sds <- apply(NUdata, MARGIN = 2, FUN = sd)

# Calculate the mean of the standard deviations
Mbest <- round(mean(age_sds), 2)

# Make an SDoSD (Sampling Distribution of Standard Deviations)
gf_histogram(~ age_sds, 
       binwidth = .1, 
       fill = "blue4", 
       color = "black") +
  labs(title = "(Fig. 3) 1,000 Standard Deviations for Age",
       x = "Standard Deviation",
       y = "Frequency") +
  geom_vline(xintercept = mean(age_sds), 
       color = "blue", 
       linewidth = 1.33)

#d.	What is the mean of the sampling distribution of the standard deviations?
Mbest

#e.	What is the standard error of the standard deviations?
SDbest <- round(sd(age_sds), 2)
SDbest
```
f.	What notation would you use to describe the mean and standard error from 3.d-e?
$$Y_i = b_0 + \epsilon_i$$
Substituting the values:
$$Y_i = `r Mbest` + `r SDbest`\epsilon_i$$

***

**Question 4.**  
According to your findings from Q1-Q3,  

a. What is your best estimate of the population mean? Why?  
The best estimate of the population mean will be the mean of the sampling distribution of means, Q2 = `r Mbest`. The mean from all the sample means is considered a better estimate of the population mean then the mean of a single sample from the dataset. The sample mean is an unbiased estimator of the population mean, and averaging many samples reduces sampling variability.
   
b. What is your best estimate of the population standard deviation? Why?  
The best estimate of the population standard deviation is the sd from the same set of means created for Q2 = `r SDbest`. Similar to the mean, the sd of the population can be estimated more closely by averaging the sd's of all samples. Each sample sd gives an estimate of the population's sd, and averaging these estimates provides a more reliable measure, again, reducing the impact of sample variability.

***

For the following questions, use your best estimates of the population mean and standard deviation (Q4).

**Question 5.**  
Simulate the sampling distribution of the mean with 100 samples of 10 students each.  
```{r Q5_Answers, echo=TRUE}
# Create an empty vector to store the sample means
set5 <- do (100) * rnorm(10, mean = Mbest, sd = SDbest)
dim(set5)

# Calculate the mean of the sample means
Q5means <- apply(set5, MARGIN = 1, FUN = mean)
mean5 <- round(mean(Q5means), 2)

#a.	Plot a histogram of the age means with a vertical line at the mean.
gf_histogram(~ Q5means, 
    binwidth = .05,
    fill = "blue4", 
    color = "black") +
  labs(title = "(Fig. 4) Age Means for 100 Samples (10 Students Each)",
    x = "Age Mean",
    y = "Frequency") +
  geom_vline(xintercept = mean5, 
    color = "blue", 
    linewidth = 1.33)

#b.	What is the mean of the sampling distribution of the means?
mean5

#c.	What is the standard error of the mean?
sde5 <- round(sd(Q5means) / sqrt(length(Q5means)), 4)
sde5
```
**Question 6.**  
Repeat the simulation in Q5, but instead of 100 samples, get 1,000 samples. 

```{r Q6_Answers, echo=TRUE}
# Create an empty vector to store the sample means
set6 <- do (1000) * rnorm(10, mean = Mbest, sd = SDbest)

dim (set6)

# Calculate the mean of the sample means
Q6means <- apply(set6, MARGIN = 1, FUN = mean)
mean6 <- round(mean(Q6means), 2)

#a.	Plot a histogram of the age means with a vertical line at the mean.
gf_histogram(~ Q6means, 
    binwidth = .05,
    fill = "blue4", 
    color = "black") +
  labs(title = "(Fig. 5) Age Means for 1,000 Samples (10 Each)",
    x = "Age Mean",
    y = "Frequency") +
  geom_vline(xintercept = mean6, 
    color = "blue", 
    linewidth = 1.33)

#b.	What is the mean of the sampling distribution of the means?
mean6

#c.	What is the standard error of the mean?
sde6 <- round(sd(Q6means) / sqrt(length(Q6means)), 4)
sde6
```
d.	What happened to the standard error of the mean, compared to the simulation with 100 samples for 10 students in Q5?  
Why do you believe this happened?  
The standard error (SE) of the mean decreased from `r sde5` to `r sde6` when you increased the samples from 100 to 1,000.  
The number of samples is the denominator for calculating SE, so as the number of samples increases, SE decreases.  
As you increase the number of samples, variability decreases. More samples becomes a more accurate estimate of the population mean, leading to a lower SE, and a more precise estimate of the population parameters.

***

**Question 7.**  
Repeat the simulation in Q5, but instead of 10 students per sample, get 1,000 students. 
```{r Q7_Answers, echo=TRUE}
# Initialize an empty vector to store the sample means
set7 <- do (100) * rnorm(1000, mean = Mbest, sd = SDbest)
dim (set7)

# Calculate the mean of the sample means
Q7means <- apply(set7, MARGIN = 1, FUN = mean)
mean7 <- round(mean(Q7means), 2)

#a.	Plot a histogram of the age means with a vertical line at the mean.
gf_histogram(~ Q7means, 
      fill = "blue4", 
      color = "black") +
  labs(title = "(Fig. 6) Age Means (100 Samples of 1,000 Students)",
      x = "Mean Age",
      y = "Frequency") +
  geom_vline(xintercept = mean7, 
      color = "blue", 
      linewidth = 1.33)

#b.	What is the mean of the sampling distribution of the means?
mean7

#c.	What is the standard error of the mean?
sde7 <- round(sd(Q7means) / sqrt(length(Q7means)), 4)
sde7 <- format(sde7, scientific = FALSE)
sde7
```
d. What happened to the standard error of the mean, compared to the simulation with 100 samples for 10 students in Q5? Why do you believe this happened?  
The standard error of the mean decreased significantly, from `r sde5` to `r sde7`.  
Increasing the sample size from 10 students to 1,000 students moves the sample closer to a better approximation of the population, reducing variability. As it is inversely related to the square root of the sample size, as the sample size increases, the SE decreases. Which makes our estimate of the population mean more precise.

e. What happened to the standard error of the mean, compared to the simulation with 1,000 samples for 10 students in Q6? Why do you believe this happened?  
Again, the standard error of the mean is also smaller, but not by as big a factor; decreasing from `r sde6` to `r sde7`.  
The reduction in SE is less pronounced compared to increasing the sample size: Increasing the number of samples (from 100 to 1,000) reduces SE, but it does so by averaging out variability across many estimates.

***

**Question 8.**  
Looking at your histograms (except Q3),

a.	Which histogram has the most spread?  
Comparing all Figures with Age Mean along the x-axis, Figure 2 from Q2 has the most spread. The histogram that plots all the age means from the entire data set. But if we want to ignore the original data set, Figure 5 has the most spread, generated with 1,000 samples of 10 students each.

b.	How can you tell?  
Three easy ways: you can tell by looking at the range of the x-axis, ensure each plot has the same scale along the x-axis and observing the width of the means distribution, or measure by running "max(i) - min(i)" for all i = vector sets created.

c.	Why is this so?  
With a smaller sample size of 10, each sample is less likely to fully capture the diversity of the population, leading to more variability. More variability signifies that the sample means will fluctuate more, leading to a wider distribution. The sample mean of a small sample is more susceptible to outliers, increasing spread. The standard error of the mean is inversely related to the sample size. With a sample size of 10, the standard error is larger, reflecting greater uncertainty and variability and translates into more spread.

***

**Question 9.**

Considering the estimates of the population mean from Q3, Q5, Q6, and Q7,

a. Which estimate would you trust most? Why?  
I would trust the scenario with 100 samples of 1,000 students each the most.  
The Central Limit Theorem tells us that as sample size increases, the distribution of the sample means approaches normal distribution, around the true population mean. Larger samples should have less variability, with 1,000 students per sample, the mean distribution is expected to be closer to the population mean. 

b. Which estimate would you trust least? Why?  
I would trust the scenario with 1,000 samples of 10 students least.  
Smaller samples are less likely to capture the diversity of the population, increasing the chance for outliers to skew the data, as we see that this histogram has the most spread. This increase in consistency and variability also increases the standard error, decreasing accuracy of the population mean.

***

**Question 10.**  
Do you believe the sample mean and standard deviation you obtained in Q1 (for one sample)  
was a good estimate of the population mean and standard deviation? Why or why not?  
The mean and standard deviation from the first sample of 100 students can be considered an okay estimate of the population parameters. A sample size of 100 is typically large enough to capture population variability, reducing sampling error. If the population is normally distributed, the mean and standard deviation are good estimators of the population. The Central Limit Theorem supports that the distribution of sample means will approximate normal, reinforcing the reliability of the sample mean as an estimator of the population mean. However, some sampling error is expected, thus multiple samples will provide more precise estimates.

***

**Question 11.**  
Write the R code to generate a random sample of 100 coin flips from a coin where the probability of heads is twice as likely as a tails.
```{r Q11_Answers, echo=TRUE}
ratio <- c(2, 1)
# Generate a random sample of 100 coin flips
coin_flips <- sample(c("Heads", "Tails"), 
     size = 100, 
     replace = TRUE, 
     prob = ratio / sum(ratio))

table(coin_flips)
```
End.